name: CI Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]
  workflow_dispatch:

env:
  AZURE_SUBSCRIPTION_ID: ${{ secrets.AZURE_SUBSCRIPTION_ID }}

jobs:
  validate:
    name: Validate Infrastructure
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
        
      - name: Setup Azure CLI
        uses: azure/setup-cli@v1
        
      - name: Install Bicep
        run: |
          az bicep upgrade
          az bicep version
          
      - name: Validate Bicep templates
        run: |
          echo "Validating main.bicep..."
          az bicep build --file infrastructure/main.bicep
          
          echo "Validating modules..."
